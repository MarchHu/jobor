(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd45da02"],{7168:function(e,t,a){},8338:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{margin:"5px 0"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData(t)}},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"路由标识"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData(t)}},model:{value:e.searchForm.routing_key,callback:function(t){e.$set(e.searchForm,"routing_key",t)},expression:"searchForm.routing_key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{value:"running",label:"运行"}}),e._v(" "),a("el-option",{attrs:{value:"stop",label:"停止"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.newRow}},[e._v("新增")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},on:{click:e.getData}},[e._v("刷新")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:"jobor_task",attrs:{border:"",data:e.data_list,size:"small"}},[a("el-table-column",{attrs:{label:"ID",prop:"id",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"name",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))]),e._v(" "),a("el-tooltip",{staticClass:"item",staticStyle:{"margin-left":"3px"},attrs:{effect:"dark",placement:"top-start"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s("<pre style='margin: 1px'>描述:\n"+t.row.description+"</pre>")},slot:"content"}),e._v(" "),t.row.description?a("i",{staticClass:"el-icon-info"}):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"lang",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{label:"表达式",prop:"expr",width:""}}),e._v(" "),a("el-table-column",{attrs:{label:"路由标识",prop:"routing_key"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"",width:"70",align:""},scopedSlots:e._u([{key:"default",fn:function(t){return["running"===t.row.status?a("el-popconfirm",{attrs:{"icon-color":"red",icon:"el-icon-info",title:"确认停止任务吗？"},on:{onConfirm:function(a){return e.changeStatus(t.row)}}},[a("el-switch",{attrs:{slot:"reference"},slot:"reference",model:{value:"running"===t.row.status,callback:function(a){e.$set(t.row,"status==='running'",a)},expression:"scope.row.status==='running'"}})],1):a("el-popconfirm",{attrs:{icon:"el-icon-info",title:"确认开始运行任务吗？"},on:{onConfirm:function(a){return e.changeStatus(t.row)}}},[a("el-switch",{attrs:{slot:"reference"},slot:"reference",model:{value:"running"===t.row.status,callback:function(a){e.$set(t.row,"status==='running'",a)},expression:"scope.row.status==='running'"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"上次执行时间",prop:"prev",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{icon:"el-icon-info",title:"确认开始手动执行任务吗？"},on:{onConfirm:function(a){return e.runTask(t.row)}}},[a("green_button",{attrs:{slot:"reference",title:"运行"},slot:"reference"})],1),e._v(" "),a("edit_button",{staticStyle:{"margin-left":"10px"},on:{click:function(a){return e.showEdit(t.row)}}}),e._v(" "),a("delete_button",{on:{click:function(a){return e.confirmDelRows(t.row,t.row.name,!0)}}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("div",{staticStyle:{display:"inline"}}),e._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right",display:"inline"}},[a("pagination",{attrs:{total:e.total,page:e.page,limit:e.limit},on:{"update:page":function(t){e.page=t},"update:limit":function(t){e.limit=t},pagination:function(t){return e.getData()}}})],1)])],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.newOrUpdate,"close-on-click-modal":!1,width:"80%"},on:{"update:visible":function(t){e.newOrUpdate=t}}},[a("el-form",{ref:"rowData",attrs:{"label-width":"120px",model:e.rowData,size:"small",rules:e.taskRules}},[a("el-form-item",{attrs:{label:"名称",prop:"name",rules:[{required:!0,message:"请输入名称",trigger:"blur"}]}},[a("el-input",{attrs:{"aria-valuemax":"60"},model:{value:e.rowData.name,callback:function(t){e.$set(e.rowData,"name",t)},expression:"rowData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入描述内容"},model:{value:e.rowData.description,callback:function(t){e.$set(e.rowData,"description",t)},expression:"rowData.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"表达式",prop:"expr"}},[a("el-input",{model:{value:e.rowData.expr,callback:function(t){e.$set(e.rowData,"expr",t)},expression:"rowData.expr"}}),e._v(" "),a("span",{staticStyle:{"font-size":"smaller",color:"#c3c4c9"}},[e._v("注：秒、分、时、天、月、周")])],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"lang",rules:[{required:!0,message:"请输入代号",trigger:"blur"}]}},[a("el-select",{on:{change:e.changeLang},model:{value:e.rowData.lang,callback:function(t){e.$set(e.rowData,"lang",t)},expression:"rowData.lang"}},[a("el-option",{attrs:{value:"shell",label:"Shell"}}),e._v(" "),a("el-option",{attrs:{value:"api",label:"Api"}}),e._v(" "),a("el-option",{attrs:{value:"python3",label:"Python3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"执行内容",prop:"data",rules:[{required:!1,message:"请输入执行内容",trigger:"blur"}]}},["api"===e.rowData.lang?a("div",[a("ul",[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:[{}],"empty-text":"please press add new"}},[a("el-table-column",{attrs:{label:"Method","min-width":"30px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:!1,size:"mini",placeholder:"请选择"},model:{value:e.rowData.data.api.method,callback:function(t){e.$set(e.rowData.data.api,"method",t)},expression:"rowData.data.api.method"}},e._l(e.methodOption,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,4062923349)}),e._v(" "),a("el-table-column",{attrs:{label:"URL","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:!1,size:"mini"},model:{value:e.rowData.data.api.url,callback:function(t){e.$set(e.rowData.data.api,"url",t)},expression:"rowData.data.api.url"}})]}}],null,!1,3878513001)})],1)],1),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:e.rowData.data.api.header,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Header头列表","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:!1,size:"mini"},model:{value:e.rowData.data.api.header[t.$index].key,callback:function(a){e.$set(e.rowData.data.api.header[t.$index],"key",a)},expression:"rowData.data.api.header[scope.$index].key"}})]}}],null,!1,2082958460)}),e._v(" "),a("el-table-column",{attrs:{prop:"age","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:!1,size:"mini"},model:{value:e.rowData.data.api.header[t.$index].value,callback:function(a){e.$set(e.rowData.data.api.header[t.$index],"value",a)},expression:"rowData.data.api.header[scope.$index].value"}})]}}],null,!1,173246144)}),e._v(" "),a("el-table-column",{attrs:{width:"70px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(a){return e.rowData.data.api.header.splice(t.$index,1)}}})]}}],null,!1,2866644252)})],1),e._v(" "),a("div",{staticStyle:{"margin-left":"11px"}},[a("el-button",{attrs:{disabled:!1,type:"text",size:"mini"},on:{click:function(t){return e.rowData.data.api.header.push({})}}},[e._v("添加")])],1)],1),e._v(" "),!1===["GET","HEAD"].includes(e.rowData.data.api.method)?a("div",[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:[{}],"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Content Type","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!1,size:"mini",filterable:""},model:{value:e.rowData.data.api.content_type,callback:function(t){e.$set(e.rowData.data.api,"content_type",t)},expression:"rowData.data.api.content_type"}},e._l(e.contentTypeOption,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,1440398723)})],1)],1),e._v(" "),"application/x-www-form-urlencoded"===e.rowData.data.api.content_type?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:e.rowData.data.api.forms,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Form List","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:!1,size:"mini"},model:{value:e.rowData.data.api.forms[t.$index].key,callback:function(a){e.$set(e.rowData.data.api.forms[t.$index],"key",a)},expression:"rowData.data.api.forms[scope.$index].key"}})]}}],null,!1,1267081766)}),e._v(" "),a("el-table-column",{attrs:{prop:"age","min-width":"100px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:!1,size:"mini"},model:{value:e.rowData.data.api.forms[t.$index].value,callback:function(a){e.$set(e.rowData.data.api.forms[t.$index],"value",a)},expression:"rowData.data.api.forms[scope.$index].value"}})]}}],null,!1,3136122522)}),e._v(" "),a("el-table-column",{attrs:{width:"70px;"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(a){return e.rowData.data.api.forms.splice(t.$index,1)}}})]}}],null,!1,2521517510)})],1),e._v(" "),a("div",{staticStyle:{"margin-left":"11px"}},[a("el-button",{attrs:{disabled:!1,type:"text",size:"mini"},on:{click:function(t){return e.rowData.data.api.forms.push({})}}},[e._v("添加")])],1)],1):e._e(),e._v(" "),"application/json"===e.rowData.data.api.content_type?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:[{}],"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Raw Requesy Body","min-width":"100px;"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("editor",{attrs:{theme:"solarized_dark",lang:"json",height:"300",options:{wrap:"free",indentedSoftWrap:!1}},on:{init:e.rowReqBodyInitEditor},model:{value:e.rowData.data.api.payload,callback:function(t){e.$set(e.rowData.data.api,"payload",t)},expression:"rowData.data.api.payload"}})],1)],1)],1)],1):e._e()]):e._e()])]):a("div",{staticStyle:{"margin-top":"5px"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("editor",{attrs:{theme:"solarized_dark",lang:e.lang[e.rowData.lang],height:"300",options:{wrap:"free",indentedSoftWrap:!1,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1}},on:{init:e.codeInitEditor},model:{value:e.rowData.data.data,callback:function(t){e.$set(e.rowData.data,"data",t)},expression:"rowData.data.data"}})],1),e._v(" "),a("br")],1)]),e._v(" "),a("el-form-item",{attrs:{label:"告警策略",prop:"alarm_policy",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-select",{model:{value:e.rowData.alarm_policy,callback:function(t){e.$set(e.rowData,"alarm_policy",t)},expression:"rowData.alarm_policy"}},e._l(e.alarmMap,(function(t,n,o){return a("el-option",{key:o,attrs:{value:t,label:e.alarmMapZH[t]}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"路由标识",prop:"routing_key",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("routing_key_select",{attrs:{"select-value":e.rowData.routing_key,clearable:!1},on:{"update:selectValue":function(t){return e.$set(e.rowData,"routing_key",t)},"update:select-value":function(t){return e.$set(e.rowData,"routing_key",t)}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"超时时间",prop:"timeout",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input-number",{staticStyle:{width:"auto"},attrs:{"controls-position":"right",min:-1,max:86400},model:{value:e.rowData.timeout,callback:function(t){e.$set(e.rowData,"timeout",t)},expression:"rowData.timeout"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"期望返回码",prop:"expect_code",rules:[{required:!0,message:"请输入期望返回码",trigger:"blur"}]}},[a("el-input-number",{staticStyle:{width:"auto"},attrs:{"controls-position":"right"},model:{value:e.rowData.expect_code,callback:function(t){e.$set(e.rowData,"expect_code",t)},expression:"rowData.expect_code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"期望返回内容"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入期望返回内容"},model:{value:e.rowData.expect_context,callback:function(t){e.$set(e.rowData,"expect_context",t)},expression:"rowData.expect_context"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"告警通知",prop:"notify"}},[a("notify",{attrs:{notify:e.rowData.notify},on:{"update:notify":function(t){return e.$set(e.rowData,"notify",t)}}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.newOrUpdate=!1}}},[e._v("取 消")]),e._v(" "),e.rowData.id?a("el-button",{attrs:{plain:!0,type:"warning",loading:e.action_loading},on:{click:function(t){return e.createOrUpdate("PUT",!1,e.rowData.id)}}},[e._v("更新")]):e._e(),e._v(" "),e.rowData.id?e._e():a("el-button",{attrs:{plain:!0,type:"warning",loading:e.action_loading},on:{click:function(t){return e.createOrUpdate("POST",!0)}}},[e._v("保存并继续")]),e._v(" "),e.rowData.id?e._e():a("el-button",{attrs:{plain:!0,type:"primary",loading:e.action_loading},on:{click:function(t){return e.createOrUpdate("POST",!1)}}},[e._v("保 存")])],1)],1)],1)},o=[],i=(a("96cf"),a("3b8d")),l=(a("c5f6"),a("7f7f"),a("26e4")),r=a("5d46"),s=a("1db2"),c=a("d329"),u=a("aa11"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticStyle:{"list-style-type":"none"}},[a("li",[a("el-checkbox",{model:{value:e.Notify.webhook["enable"],callback:function(t){e.$set(e.Notify.webhook,"enable",t)},expression:"Notify.webhook['enable']"}},[e._v("Webhook")]),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.Notify.webhook.urls.push("")}}},[e._v("添加")]),e._v(" "),e._l(e.Notify.webhook.urls,(function(t,n){return a("div",{key:n,staticStyle:{margin:"3px 0"}},[a("el-input",{staticStyle:{"max-width":"360px"},attrs:{"aria-valuemax":"512",placeholder:"请输入api地址"},model:{value:e.Notify.webhook.urls[n],callback:function(t){e.$set(e.Notify.webhook.urls,n,t)},expression:"Notify.webhook.urls[index]"}},[a("template",{slot:"prepend"},[e._v("api地址")])],2),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(t){return e.Notify.webhook.urls.splice(n,1)}}})],1)}))],2),e._v(" "),a("li",[a("el-checkbox",{model:{value:e.Notify.email.enable,callback:function(t){e.$set(e.Notify.email,"enable",t)},expression:"Notify.email.enable"}},[e._v("邮件")]),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.Notify.email.receivers.push("")}}},[e._v("添加")]),e._v(" "),e._l(e.Notify.email.receivers,(function(t,n){return a("div",{key:n,staticStyle:{margin:"3px 0"}},[a("el-input",{staticStyle:{"max-width":"360px"},attrs:{"aria-valuemax":"256",placeholder:"请输入邮箱地址"},model:{value:e.Notify.email.receivers[n],callback:function(t){e.$set(e.Notify.email.receivers,n,t)},expression:"Notify.email.receivers[index]"}},[a("template",{slot:"prepend"},[e._v("邮箱地址")])],2),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(t){return e.Notify.email.receivers.splice(n,1)}}})],1)}))],2),e._v(" "),a("li",[a("el-checkbox",{model:{value:e.Notify.lark.enable,callback:function(t){e.$set(e.Notify.lark,"enable",t)},expression:"Notify.lark.enable"}},[e._v("飞书")]),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.Notify.lark.webhooks.push({})}}},[e._v("添加")]),e._v(" "),e._l(e.Notify.lark.webhooks,(function(t,n){return a("div",{key:n,staticStyle:{margin:"3px 0"}},[a("el-input",{staticStyle:{"max-width":"360px"},attrs:{"aria-valuemax":"256",placeholder:"请输入飞书webhook url"},model:{value:t.webhook_url,callback:function(a){e.$set(t,"webhook_url",a)},expression:"item.webhook_url"}},[a("template",{slot:"prepend"},[e._v("webhook url")])],2),e._v(" "),a("el-input",{staticStyle:{"max-width":"240px","margin-left":"3px"},attrs:{"aria-valuemax":"256",type:"password",placeholder:"请输入飞书webhook Secret"},model:{value:t.secret,callback:function(a){e.$set(t,"secret",a)},expression:"item.secret"}},[a("template",{slot:"prepend"},[e._v("Secret")])],2),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(t){return e.Notify.lark.webhooks.splice(n,1)}}})],1)}))],2),e._v(" "),a("li",[a("el-checkbox",{model:{value:e.Notify.dingding.enable,callback:function(t){e.$set(e.Notify.dingding,"enable",t)},expression:"Notify.dingding.enable"}},[e._v("钉钉")]),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.Notify.dingding.webhooks.push({})}}},[e._v("添加")]),e._v(" "),e._l(e.Notify.dingding.webhooks,(function(t,n){return a("div",{key:n,staticStyle:{margin:"3px 0"}},[a("el-input",{staticStyle:{"max-width":"360px"},attrs:{"aria-valuemax":"256",placeholder:"请输入钉钉webhook url"},model:{value:t.webhook_url,callback:function(a){e.$set(t,"webhook_url",a)},expression:"item.webhook_url"}},[a("template",{slot:"prepend"},[e._v("webhook url")])],2),e._v(" "),a("el-input",{staticStyle:{"max-width":"240px","margin-left":"3px"},attrs:{"aria-valuemax":"256",type:"password",placeholder:"请输入钉钉webhook Secret"},model:{value:t.secret,callback:function(a){e.$set(t,"secret",a)},expression:"item.secret"}},[a("template",{slot:"prepend"},[e._v("Secret")])],2),e._v(" "),a("el-button",{staticClass:"add-btn",attrs:{disabled:!1,size:"mini",icon:"el-icon-delete",type:"danger",circle:""},on:{click:function(t){return e.Notify.dingding.webhooks.splice(n,1)}}})],1)}))],2)])},p=[],m={name:"notify",props:{notify:{email:{enable:!1,receivers:[]},webhook:{enable:!1,urls:[]},lark:{enable:!1,webhooks:[]},dingding:{enable:!1,webhooks:[]}}},watch:{notify:function(){this.Notify=this.notify},Notify:function(){this.$emit("update:notify",this.Notify)}},data:function(){return{Notify:this.notify}},components:{delete_button:r["a"],edit_button:s["a"],green_button:c["a"]}},f=m,b=(a("dfe0"),a("2877")),h=Object(b["a"])(f,d,p,!1,null,"35bac164",null),w=h.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("el-select",{attrs:{value:e.SelectValue,filterable:"",placeholder:"请选择",clearable:e.clearable,multiple:!e.single_selection,"allow-create":e.allowCreate},on:{change:e.handleChange}},e._l(e.data_list,(function(e,t){return a("el-option",{key:t,attrs:{label:e.routing_key,value:e.routing_key}})})),1)],1)},y=[],v={name:"routing_key_select",props:{single_selection:{default:!0},use_code:{default:!1},clearable:{default:!0},allowCreate:{default:!1},SelectValue:{required:!1}},data:function(){return{url:this.$store.state.urls.jobor_routing_key_url,data_list:[],total:0}},watch:{},methods:{getData:function(){var e=this,t={};this.$store.dispatch("common/Query",{url:this.url,data:t}).then((function(t){e.data_list=t.data.data.list,e.total=t.data.data.total})).catch((function(e){}))},handleChange:function(e){this.$emit("update:select-value",e)}},mounted:function(){this.getData()}},g=v,k=Object(b["a"])(g,_,y,!1,null,"5e11fa52",null),x=k.exports,D=a("fe8c"),S=a("cf45"),$=a("01a8"),N={name:"jobor_task",mixins:[D["a"]],data:function(){var e=function(e,t,a){Object($["isValidCron"])(t,{seconds:!0})?a():a(new Error("cron表达式不正确, 例：* * * * * *"))},t=function(e,t,a){if(t.webhook&&t.webhook.urls)for(var n=0;n<t.webhook.urls.length;n++)Object(S["d"])(t.webhook.urls[n])||a(new Error("webhook url格式不正确, 例：http://api.xx.com/ping"));if(t.email&&t.email.receivers)for(var o=0;o<t.email.receivers.length;o++)Object(S["a"])(t.email.receivers[o])||a(new Error("邮箱格式不正确, 例：zhangsan@email.com"));if(t.lark&&t.lark.webhooks)for(var i=0;i<t.lark.webhooks.length;i++)Object(S["d"])(t.lark.webhooks[i].webhook_url)||a(new Error("飞书 webhook url格式不正确, 例：http://lark.xx.com/ping"));if(t.lark&&t.dingding.webhooks)for(var l=0;l<t.dingding.webhooks.length;l++)Object(S["d"])(t.dingding.webhooks[l].webhook_url)||a(new Error("钉钉 webhook url格式不正确, 例：http://dingding.xx.com/ping"));a()};return{searchForm:{name:"",routing_key:"",status:""},taskRules:{expr:[{required:!0,trigger:"blur",validator:e}],notify:[{required:!1,trigger:"blur",validator:t}]},notify:{email:{enable:!1,receivers:[]},webhook:{enable:!1,urls:[]},lark:{enable:!1,webhooks:[]},dingding:{enable:!1,webhooks:[]}},rowData:{name:"",lang:"shell",id:"",expr:"* * * * * *",timeout:-1,retry:0,routing_key:"",expect_code:0,expect_context:"",alarm_policy:2,description:"",data:{data:"",api:{url:"",method:"GET",content_type:"",payload:"",header:[],forms:[]}},notify:{email:{enable:!1,receivers:[]},webhook:{enable:!1,urls:[]},lark:{enable:!1,webhooks:[]},dingding:{enable:!1,webhooks:[]}}},url:this.$store.state.urls.jobor_task_url,alarmMap:{never:0,always:1,failed:2,success:3},alarmMapZH:{0:"从不",1:"总是",2:"失败",3:"成功"},lang:{shell:"sh",python3:"python",golang:"golang",api:"sh"},apiRow:{url:"",method:"GET",content_type:"",payload:"",header:{},forms:[{}]},headerList:[{}],method:"",methodOption:[{value:"GET",label:"GET"},{value:"HEAD",label:"HEAD"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"PATCH",label:"PATCH"},{value:"DELETE",label:"DELETE"}],content_type:"",contentTypeOption:[{value:"application/json",label:"application/json"},{value:"application/x-www-form-urlencoded",label:"application/x-www-form-urlencoded"}],langExample:{shell:'#!/usr/bin/env sh\nfunction main() {\n    echo "run shell"\n}\n\nmain\n        ',python3:"#!/usr/bin/env python3\ndef main():\n    print(\"run python3\")\n\nif __name__ == '__main__':\n    main()",python:"#!/usr/bin/env python\ndef main():\n    print(\"run python\")\n\nif __name__ == '__main__':\n    main()",golang:'package main\n\nimport "fmt"\n\nfunc main() {\n  fmt.Println("run golang")\n}',nodejs:'#!/usr/bin/env node\nconsole.log("run nodejs")',windowsbat:"tasklist",api:""}}},methods:{showEdit:function(e){this.newOrUpdate=!0,this.title="编辑",this.rowData.id=e.id,this.rowData.name=e.name,this.rowData.data=e.data,this.rowData.notify=e.notify,this.rowData.lang=e.lang,this.rowData.timeout=Number(e.timeout),this.rowData.expr=e.expr,this.rowData.routing_key=e.routing_key,this.rowData.expect_code=e.expect_code,this.rowData.expect_context=e.expect_context,this.rowData.alarm_policy=e.alarm_policy,this.rowData.description=e.description,this.rowData.notify.email.receivers||(this.rowData.notify.email.receivers=[]),this.rowData.notify.webhook.urls||(this.rowData.notify.webhook.urls=[]),this.rowData.notify.lark.webhooks||(this.rowData.notify.lark.webhooks=[]),this.rowData.notify.dingding.webhooks||(this.rowData.notify.dingding.webhooks=[])},newRow:function(){this.newOrUpdate=!0,this.title="添加",this.rowData.id="",this.rowData.name="",this.rowData.lang="shell",this.rowData.timeout=-1,this.rowData.expr="* * * * * *",this.rowData.retry=0,this.rowData.expect_code=0,this.rowData.expect_context="",this.rowData.routing_key="",this.rowData.alarm_policy=2,this.rowData.description="",this.rowData.data={data:this.langExample[this.rowData.lang],api:{url:"",method:"GET",content_type:"",payload:"",header:[],forms:[]}},this.rowData.notify=JSON.parse(JSON.stringify(this.notify))},changeStatus:function(e){var t=this,a="stop";"running"!==e.status&&(a="running");var n=this.url+"/"+e.id+"/"+a;this.$store.dispatch("common/CreateUpdate",{url:n,method:"PUT",data:{}}).then((function(e){t.$message.success(e.data.message),t.getData()})).catch((function(e){t.getData()}))},changeLang:function(){this.rowData.data.data=this.langExample[this.rowData.lang]||""},codeInitEditor:function(e){e.setAutoScrollEditorIntoView(!0),e.setShowPrintMargin(!1),a("2099"),a("446e"),a("8882"),a("32ff"),a("4e93"),a("4c5b"),a("6c73")},realLogInitEditor:function(e){e.setAutoScrollEditorIntoView(!0),e.setShowPrintMargin(!1),e.on("change",(function(){e.renderer.scrollToLine(Number.POSITIVE_INFINITY)})),a("8a2a"),a("6c73")},rowReqBodyInitEditor:function(e){e.setAutoScrollEditorIntoView(!0),e.setShowPrintMargin(!1),a("818b"),a("6c73")},runTask:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a="".concat(this.url,"/").concat(t.id,"/run"),e.next=4,this.$store.dispatch("common/Request",{url:a,method:"POST",data:{}});case 4:return n=e.sent,this.$message({message:n.data.message,type:"success"}),e.next=8,this.getData();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.$message({message:String(e.t0),type:"error"});case 13:return e.prev=13,e.finish(13);case 15:case"end":return e.stop()}}),e,this,[[0,10,13,15]])})));function t(t){return e.apply(this,arguments)}return t}()},mounted:function(){this.getData()},components:{pagination:l["a"],notify:w,delete_button:r["a"],edit_button:s["a"],user_select:u["a"],green_button:c["a"],routing_key_select:x,editor:a("7c9e")}},E=N,O=(a("a986"),Object(b["a"])(E,n,o,!1,null,"0e6a76c8",null));t["default"]=O.exports},a986:function(e,t,a){"use strict";a("7168")},dfe0:function(e,t,a){"use strict";a("e1d4")},e1d4:function(e,t,a){}}]);