version: '3.5'
services:
  controller:
        image: xxxxx
        container_name: jobor_controller
        restart: always
        ports: 
          - 8000:8000
        volumes: 
          - ./docker_config.toml:/app/core.toml
        depends_on:
          - mysql
          - redis
    worker:
        image: xxxx
        container_name: jobor_worker
        volumes: 
            - ./docker_config.toml:/app/core.toml
        depends_on:
          - master
    mysql:
        image: mysql:5.7
#        command: [mysqld, --character-set-server=utf8, --collation-server=utf8_bin]
        environment:
            MYSQL_ROOT_PASSWORD: "jobor123"
            MYSQL_DATABASE: "jobor"
        volumes:
          - "./mysql_data/var/lib/mysql:/var/lib/mysql:rw"
          - "./mysql_data/etc/mysql/my.cnf:/etc/mysql/my.cnf"
          - "/etc/localtime:/etc/localtime:ro"
        ports:
          - 3306:3306

    redis:
        image: redis:5
#        image: redis:latest
        restart: always
        ports: 
          - 6379:6379